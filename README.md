# Dungeon Hero

Dungeon Hero — це інтерактивна комп'ютерна гра, де гравець переміщуються через різні рівні підземелля, борються з ворогами та збирають лут. Цей документ надає вичерпний гід по функціоналу програми, як запустити її локально, а також деталі про принципи програмування, патерни проєктування та техніки рефакторингу, використані в проєкті.

## Зміст
- [Функціонал](#Функціонал)
- [Запуск програми локально](#Запуск-програми-локально)
- [Принципи програмування](#Принципи-програмування)
- [Патерни проєктування](#Патерни-проєктування)
- [Техніки рефакторингу](#Техніки-рефакторингу)
- [Коментарі до коду](#Коментарі-до-коду)

## Функціонал
Dungeon Hero пропонує наступні можливості:
- **Навігація героя**: Гравці можуть переміщувати свого героя через різні рівні підземелля.
- **Система бою**: Боротьба з різними ворогами.
- **Збір скарбів**: Знаходження та збирання скарбів для збільшення очок і можливостей.
- **Прогресія рівнів**: Проходження різних рівнів зі збільшенням складності.
- **Аудіо ефекти**: Відтворення звукових ефектів для покращення занурення у гру.
- **Контейнери для предметів**: Додавання, видалення та розкидання предметів у контейнерах.

## Запуск програми локально
Щоб запустити гру Dungeon Hero локально, виконайте наступні кроки:

### Клонувати репозиторій
```sh
git clone https://github.com/ShadowGhost31/CourseWorkDungeon.git
```
## Зібрати проект
Переконайтеся, що у вас встановлений VisualStudio для редагування коду на С#.
## Запустити гру
Запустити Dungeon.sln
### Принцип єдиного обов'язку (SRP)

Принцип єдиного обов'язку стверджує, що кожен клас повинен мати лише одну причину для зміни, тобто відповідати лише за одну функціональність. Наприклад, у вашій програмі DungeonHero відповідає за обробку атрибутів та дій героя, тоді як DungeonLevel управляє структурою та прогресом підземелля.

### Принцип відкритості/закритості (OCP)

Цей принцип стверджує, що програма має бути відкритою для розширення, але закритою для модифікації. Тобто, нові функціональності можуть бути додані без зміни вже існуючого коду. У вашій системі, нові рівні, вороги або предмети можуть бути додані шляхом розширення існуючих класів, не модифікуючи їх.

### Принцип підстановки Лісков (LSP)

Принцип підстановки Лісков стверджує, що об'єкти повинні бути замінними на екземпляри їх підтипів без зміни правильності програми. Наприклад, ви можете вводити різні типи ворогів, усі з яких дотримуються загального інтерфейсу.

### Принцип розділення інтерфейсу (ISP)

Принцип розділення інтерфейсу стверджує, що клієнти не повинні залежати від інтерфейсів, які вони не використовують. Інтерфейси повинні бути специфічними для конкретних дій. Це забезпечує, що класи-реалізації повинні визначати лише ті методи, які для них актуальні.

### Принцип інверсії залежностей (DIP)

Принцип інверсії залежностей стверджує, що високорівневі модулі не повинні залежати від низькорівневих модулів. Вони повинні залежати від абстракцій. У вашій грі, різні компоненти взаємодіють через інтерфейси та абстрактні класи, що дозволяє зберігати систему більш гнучкою.
### Патерни проєктування

#### Фабричний патерн (Factory Pattern)

Використовується в DungeonLevel для динамічного створення різних типів рівнів підземелля. Це допомагає керувати складністю створення рівнів і дозволяє легко додавати нові типи рівнів.

#### Патерн спостерігача (Observer Pattern)

Реалізований у системі бою для обробки подій, таких як атаки ворогів і зміни здоров'я героя, дозволяючи різним частинам системи реагувати на ці події без тісного зв'язку між ними.

#### Патерн стратегії (Strategy Pattern)

Використовується для бойових стратегій героя, дозволяючи змінювати різні бойові поведінки під час виконання програми.

### Техніки рефакторингу

#### Виділення методу (Extract Method)

Складні методи були розділені на менші, більш керовані методи для покращення читабельності та підтримуваності коду.

#### Перейменування змінної (Rename Variable)

Змінні та методи отримали описові назви, щоб зробити код більш зрозумілим.

#### Інкапсуляція поля (Encapsulate Field)

Прямий доступ до полів класу був замінений на властивості, щоб забезпечити інкапсуляцію та контроль над тим, як поля отримуються та змінюються.

### Дотримання принципів, патернів та технік

Дотримання цих принципів, патернів та технік забезпечує чистий, підтримуваний та розширюваний код у грі Dungeon Hero.

#### Коментарі до коду

### AudioEffect.cs

Клас AudioEffect відповідає за відтворення звукових ефектів у грі. Він дозволяє відтворювати, зупиняти, паузувати звукові ефекти, а також встановлювати гучність.

Основні функції:

- Конструктор: Ініціалізує об'єкт AudioEffect, задає повторення, відкриває аудіофайл та встановлює гучність.
- media_player_MediaOpened: Видаляє тимчасовий файл після відкриття медіафайла.
- media_player_MediaEnded: Перевіряє, чи потрібно повторювати аудіо, і відповідно або повторює його, або зупиняє.
- ExtractAudioResource: Витягує аудіоресурс з UnmanagedMemoryStream і зберігає його у тимчасовий файл.
- SetVolume: Встановлює гучність медіаплеєра.
- Play: Відтворює аудіо.
- Stop: Зупиняє відтворення аудіо.
- Pause: Пауза аудіо.

Клас також використовує події MediaOpened та MediaEnded для керування станом відтворення аудіо.

### DungeonBlock.cs

Клас DungeonBlock є підкласом DungeonObject і представляє блок підземелля. Він використовується для створення графічних елементів підземелля з можливістю визначення типу колізії.

Основні функції:

- Конструктор: Ініціалізує об'єкт DungeonBlock з зображенням та типом колізії.

### DungeonBlock.cs

Клас `DungeonBlock` відображає блок у підземеллі і є підкласом `DungeonObject`. Він використовується для представлення графічних елементів у підземеллі та має можливість визначення типу колізії, що дозволяє герою взаємодіяти з блоками у грі.

Основні функції та властивості:

- **Конструктор**: Ініціалізує об'єкт `DungeonBlock` з заданим зображенням та типом колізії.

- **Image**: Зображення блоку, яке відображається у грі.

- **CollisionType**: Тип колізії блоку, який визначає, чи може герой взаємодіяти з цим блоком та як саме.

Додатково, цей клас може містити інші методи та властивості, що визначають поведінку та властивості блоків у грі.
### DungeonEffect.cs

Клас `DungeonEffect` відповідає за ефекти, які впливають на статистику героя в підземеллі. Цей клас забезпечує можливість застосування ефектів до героя, визначення їхньої тривалості та значення. 

Основні функції та властивості:

- **Stat**: Властивість, яка повертає статистику, яку змінює ефект.
- **Value**: Значення ефекту, яке впливає на відповідну статистику героя.
- **Duration**: Тривалість ефекту у мілісекундах.
- **UsageTime**: Час застосування ефекту у мілісекундах.

Основні методи:

- **DungeonEffect**: Конструктор, який ініціалізує об'єкт ефекту з вказаною статистикою, значенням та тривалістю.
- **InitializeTimers**: Метод, який ініціалізує таймер для відліку часу застосування ефекту.
- **AddToCreature**: Метод, який призначає власника ефекту - об'єкт `DungeonCreature`.
- **TurnEffectOn**: Метод, який вмикає ефект, додаючи його до власника та запускаючи таймер, якщо тривалість ефекту не дорівнює -1.
- **TurnEffectOff**: Метод, який вимикає ефект, видаляючи його від власника та зупиняючи таймер, якщо тривалість ефекту не дорівнює -1.
- **timer_usage_Tick**: Метод, який викликається таймером для відліку часу застосування ефекту.

Цей клас дозволяє створювати та керувати різними ефектами, які впливають на героя під час його подорожі по підземеллю.
### DungeonGraphicEffect.cs

Клас `DungeonGraphicEffect` представляє графічний ефект у підземеллі. Він є підкласом `DungeonObject` і використовується для відтворення анімаційних ефектів у грі.

Основні функції та властивості:

- **DungeonLevel**: Посилання на рівень підземелля, до якого відноситься ефект.
- **GifImage**: Зображення GIF, яке використовується для анімації ефекту.
- **TimerPlayIsWorking**: Прапорець, що вказує, чи активний таймер відтворення.

Основні методи:

- **DungeonGraphicEffect**: Конструктор, який ініціалізує об'єкт графічного ефекту з вказаним зображенням GIF та позицією.
- **InitializeTimers**: Ініціалізує таймер для відтворення анімації.
- **Play**: Метод, який розпочинає відтворення анімації ефекту.
- **Stop**: Метод, який зупиняє відтворення анімації та знищує об'єкт.

Основний таймер відтворення викликає метод `timer_play_Tick`, який керує логікою відтворення кадрів GIF.

Цей клас дозволяє відтворювати анімаційні ефекти в підземеллі, що підвищує візуальну привабливість гри.
### DungeonHero.cs

Клас `DungeonHero` представляє головного героя у середовищі підземелля. Він успадковується від `DungeonCreature` і має конкретні властивості, щоб відстежувати прогрес та дії героя.

#### Властивості та Поля:

- **WalkthrowTime**: Відстежує загальний час, який герой провів у русі.
- **DistanceWalked**: Вказує загальну відстань, пройдену героєм.
- **MonstersKilled**: Записує загальну кількість знищених монстрів героєм.
- **MonstersBossesKilled**: Веде облік загальної кількості босів, знищених героєм.
- **DoorsOpened**: Підраховує загальну кількість відкритих дверей героєм.
- **DoorsCodeOpened**: Відстежує загальну кількість відкритих дверей за допомогою коду.
- **ChestsOpened**: Вказує загальну кількість відкритих скарбниць героєм.

#### Конструктор:

- **DungeonHero**: Ініціалізує новий екземпляр класу `DungeonHero` з вказаними параметрами, такими як текстура, ім'я, максимальне здоров'я, швидкість відновлення, максимальна енергія тощо.

Цей клас служить головним героєм гри, дозволяючи гравцям навігувати підземеллям, брати участь у боях та взаємодіяти з різноманітними елементами.
### DungeonItem.cs

Клас `DungeonItem` представляє предмет у грі. Він успадковується від `DungeonObject` та має властивості та методи для взаємодії з предметом.

#### Властивості та Поля:

- **CanUse**: Показує, чи можна використовувати цей предмет.
- **CanDrop**: Вказує, чи можна відкидати цей предмет.
- **CanDestroy**: Показує, чи можна знищити цей предмет.
- **Name**: Назва предмету.
- **Description**: Опис предмету.
- **FullDescription**: Повний опис предмету, який може містити додаткові деталі.
- **Container**: Контейнер, до якого належить цей предмет.

#### Конструктор:

- **DungeonItem**: Ініціалізує новий екземпляр класу `DungeonItem` з вказаними параметрами, такими як зображення, можливість використання, можливість відкидання, можливість знищення, назва та опис предмету.

Цей клас дозволяє створювати різні предмети у грі та взаємодіяти з ними, такими як використання, відкидання та знищення.
### DungeonItemArmour.cs

Клас `DungeonItemArmour` є підкласом `DungeonItemEquipment` та представляє екіпіровку броні у грі. Він містить додаткові поля та методи для роботи з бронею.

#### Поля:

- **QualityId**: Якість броні, представлена у вигляді числа від 0 до 9.
- **StyleId**: Стиль броні, представлений у вигляді числа від 0 до 2.

#### Конструктор:

- **DungeonItemArmour**: Ініціалізує новий екземпляр класу `DungeonItemArmour` з вказаними параметрами, такими як якість, стиль, назва та опис броні.

#### Методи:

- **GetImageOnDirection**: Повертає зображення броні у вказаному напрямку.

Цей клас дозволяє створювати та використовувати різні типи броні у грі з різними якостями та стилями.
### DungeonItemArtifact.cs

Клас `DungeonItemArtifact` є підкласом `DungeonItemEquipment` та представляє артефакти у грі. Він має додаткове поле та методи для роботи з артефактами.

#### Поля:

- **IsSpecial**: Поле, яке показує, чи є артефакт спеціальним.

#### Конструктор:

- **DungeonItemArtifact**: Ініціалізує новий екземпляр класу `DungeonItemArtifact` з вказаними параметрами, такими як якість, стиль, назва та опис артефакту.

#### Методи:

- **SetImagesFromTexture**: Встановлює зображення артефакту з текстури за вказаними параметрами якості та стилю.

Цей клас дозволяє створювати та використовувати артефакти у грі, які можуть мати різні властивості та особливості.
### DungeonItemEquipment.cs

Клас `DungeonItemEquipment` є підкласом `DungeonItem` та представляє екіпіровку предметів у грі. Він має можливість додавати ефекти до екіпіровки, управляти ефектами, а також змінювати повний опис предмету в залежності від наявних ефектів.

#### Поля:

- **Effects**: Список ефектів, які має екіпіровка.
- **TotalEffectsNumber**: Загальна кількість ефектів, що додаються до екіпіровки.
- **IsEquip**: Показує, чи екіпірована дана екіпіровка.

#### Конструктор:

- **DungeonItemEquipment**: Ініціалізує новий екземпляр класу `DungeonItemEquipment` з вказаними параметрами.

#### Методи:

- **AddEffect**: Додає новий ефект до екіпіровки за вказаними параметрами.
- **GetEffectValue**: Повертає значення ефекту за вказаним ідентифікатором статистики.
- **StartEffects**: Запускає ефекти екіпіровки на зазначеному персонажі.
- **Equip**: Екіпірує предмет на персонажа та запускає ефекти.
- **UnEquip**: Знімає екіпіровку та зупиняє ефекти.

Цей клас дозволяє створювати та використовувати різні екіпіровки в грі, які можуть надавати різноманітні ефекти персонажу.
### DungeonItemHelmet.cs

Клас `DungeonItemHelmet` є підкласом `DungeonItemEquipment` та представляє головний убір у грі. Він має можливість додавати ефекти до екіпіровки, управляти ефектами та змінювати зображення головного убору в залежності від напрямку руху персонажа.

#### Поля:

- **m_quality_id**: Якість головного убору.
- **m_style_id**: Стиль головного убору.

#### Конструктор:

- **DungeonItemHelmet**: Ініціалізує новий екземпляр класу `DungeonItemHelmet` з вказаними параметрами.

#### Методи:

- **GetImageOnDirection**: Повертає зображення головного убору в залежності від напрямку руху персонажа.

Цей клас дозволяє створювати та використовувати різні головні убори в грі, які можуть надавати різноманітні ефекти персонажу та змінювати свій вигляд залежно від напрямку руху.
### DungeonItemKey.cs

Клас `DungeonItemKey` є підкласом `DungeonItem` та представляє ключ у грі. Ключ може мати різні кольори, які використовуються для відкриття дверей того ж кольору.

#### Поля:

- **colors_count**: Лічильник кольорів ключів.

#### Властивості:

- **Color**: Колір ключа.

#### Конструктор:

- **DungeonItemKey**: Ініціалізує новий екземпляр класу `DungeonItemKey` з вказаними параметрами.

#### Методи:

- **SetImages**: Встановлює зображення ключа з вказаним кольором.
- **UpdateFullDescription**: Оновлює повний опис ключа.

#### Статичні методи:

- **ResetColorsCount**: Скидає лічильник кольорів ключів.
- **GetNextColor**: Повертає наступний колір для нового ключа.

Цей клас дозволяє створювати ключі різних кольорів, які використовуються для відкриття відповідних за кольором дверей у грі.
### DungeonItemPaper.cs

Клас `DungeonItemPaper` є підкласом `DungeonItem` та представляє записку у грі. Записка містить текстову інформацію та може бути знайдена у скриньках на різних рівнях.

#### Поля:

- **m_text**: Текст записки.

#### Конструктор:

- **DungeonItemPaper**: Ініціалізує новий екземпляр класу `DungeonItemPaper` з вказаними параметрами.

#### Методи:

- **UpdateFullDescription**: Оновлює повний опис записки.
- **GenerateTextWithNumber**: Генерує текст записки з вказаним номером та позицією.

Цей клас дозволяє створювати записки з текстовою інформацією, які можуть містити номери та інші важливі дані для гравця у грі.
### DungeonItemSword.cs

Клас `DungeonItemSword` є підкласом `DungeonItemEquipment` та представляє собою меч у грі. Меч може бути використаний гравцем для атаки монстрів.

#### Поля:

- **m_quality_id**: Ціле число, що визначає якість меча.
- **TotalFrame**: Ціле число, що визначає загальну кількість кадрів меча.

#### Конструктор:

- **DungeonItemSword**: Ініціалізує новий екземпляр класу `DungeonItemSword` з вказаними параметрами.

#### Методи:

- **GetImageOnDirection**: Повертає зображення меча для вказаного напрямку руху.

Цей клас дозволяє створювати мечі з різними параметрами якості та використовувати їх гравцем для атаки монстрів у грі.
### DungeonItemPotion.cs

Клас `DungeonItemPotion` є підкласом `DungeonItemEquipment` та представляє зілля у грі. Зілля може бути використане гравцем для зміни характеристик протягом певного часу.

#### Поля:

Немає додаткових полів, використовуються поля з батьківського класу `DungeonItemEquipment`.

#### Конструктор:

- **DungeonItemPotion**: Ініціалізує новий екземпляр класу `DungeonItemPotion` з вказаними параметрами якості та стилю.

#### Методи:

- **SetImagesFromTexture**: Встановлює зображення зілля з текстури за вказаними параметрами якості та стилю.

Цей клас дозволяє створювати зілля з різними параметрами якості та стилю, які можуть бути використані гравцем у грі для зміни характеристик на певний час.
### DungeonMonster.cs

Клас `DungeonMonster` є підкласом `DungeonCreature` та представляє собою монстра у грі.

#### Поля:

- **thinking_time**: Статичне поле, що визначає час, необхідний монстру на обміркування дій перед наступним кроком.
- **m_is_boss**: Показує, чи є цей монстр босом.
- **m_action_status**: Поточний статус дій монстра.
- **m_is_attached_to_room**: Вказує, чи прив'язаний монстр до певної кімнати.
- **m_connection_point_attached**: Точка з'єднання, до якої прив'язаний монстр.
- **m_target_location**: Місце, до якого монстр рухається.
- **m_thinking_timer_is_working**: Показує, чи працює таймер обміркування дій монстра.
- **m_thinking_timer**: Таймер для обміркування дій монстра.
- **m_moving_timer_is_working**: Показує, чи працює таймер руху монстра.
- **m_moving_timer**: Таймер для руху монстра.

#### Конструктор:

- **DungeonMonster**: Ініціалізує новий екземпляр класу `DungeonMonster` з вказаними параметрами.

#### Методи:

- **InitializeTimers**: Ініціалізує таймери для обміркування дій та руху монстра.
- **DistributeAllSkillPoints**: Розподіляє всі доступні очки навичок монстра.
- **GiveKey**: Додає ключ до інвентаря монстра.
- **AttachToConnectionPoint**: Прив'язує монстра до точки з'єднання.
- **SetTargetLocation**: Встановлює місце, до якого монстр рухатиметься.
- **MakeStepToTargetLocation**: Робить крок до цільового місця.
- **StartThinking**: Починає процес обміркування дій.
- **StopThinking**: Зупиняє процес обміркування дій.
- **StartFighting**: Починає процес бою.
- **m_thinking_timer_Tick**: Обробник події таймера обміркування дій монстра.
- **m_moving_timer_Tick**: Обробник події таймера руху монстра.
- **IsInPlayerView**: Вказує, чи монстр знаходиться в полі зору гравця.

Цей клас відображає монстра у грі та керує його рухом та діями.
### DungeonObject.cs

Клас `DungeonObject` є базовим класом для всіх об'єктів у грі.

#### Поля:

- **m_image**: Зображення об'єкту.
- **m_size**: Розмір об'єкту.
- **m_collision_type**: Тип колізії об'єкту.
- **m_collision_size**: Розмір колізії об'єкту.
- **m_collision_offset**: Зміщення колізії об'єкту.
- **DungeonLevel**: Поверхня, на якій знаходиться об'єкт.
- **m_location**: Місцезнаходження об'єкту.
- **ObjectStatus**: Статус об'єкту.

#### Конструктор:

- **DungeonObject**: Ініціалізує новий екземпляр класу `DungeonObject` з вказаними параметрами.

#### Методи:

- **SetLocation**: Встановлює місцезнаходження об'єкту.
- **Destroy**: Знищує об'єкт.
- **Paint**: Малює об'єкт на екрані відносно позиції гравця.
- **IsInView**: Перевіряє, чи об'єкт знаходиться в полі зору гравця.

Цей клас виступає базою для всіх об'єктів у грі та містить загальні властивості та методи для роботи з ними.
### DungeonOwner.cs

Клас `DungeonOwner` є базовим класом для об'єктів, які можуть володіти іншими об'єктами у грі.

#### Конструктор:

- **DungeonOwner**: Захищений конструктор, що ініціалізує новий екземпляр класу `DungeonOwner`.

Цей клас використовується як базовий клас для об'єктів, які можуть володіти іншими об'єктами у грі.```
### DungeonPoint.cs

Клас `DungeonPoint` представляє собою точку в двовимірному просторі гри.

#### Поля:

- **X**: Значення координати X точки.
- **Y**: Значення координати Y точки.

#### Властивості:

- **Point**: Отримується об'єкт типу `Point` з цих координат.

#### Конструктор:

- **DungeonPoint**: Ініціалізує новий екземпляр класу `DungeonPoint` з вказаними значеннями координат.

#### Методи:

- **GetLengthTo**: Обчислює відстань від поточної точки до вказаної точки за допомогою формули відстані між двома точками у двовимірному просторі.

Цей клас використовується для представлення точок у грі та обчислення відстані між ними.``` 
### DungeonStatsInfo.cs

Клас `DungeonStatsInfo` є абстрактним і містить статичні методи для отримання інформації про різні статистики в грі.

#### Методи:

- **Name**: Повертає назву вказаної статистики.
- **Max**: Повертає максимальне значення для вказаної статистики.
- **Plus**: Повертає значення, яке додається при підвищенні вказаної статистики.
- **GetColor**: Повертає колір, пов'язаний з вказаною статистикою.

Цей клас допомагає створювати статистики в грі та забезпечує консистентність у назвах, максимальних значеннях та кольорах, пов'язаних з кожною статистикою.```
### Клас GifAnimation

#### Поля:
- **m_images**: Список об'єктів типу Bitmap, що представляють кадри анімації.

#### Конструктор:
- **GifAnimation()**: Ініціалізує новий екземпляр класу GifAnimation з порожнім списком кадрів.

#### Методи:
- **AddFrame(Bitmap image)**: Додає новий кадр до анімації, додаючи наданий об'єкт типу Bitmap до списку кадрів.
- **GetFrame(int frame_id)**: Отримує кадр за вказаним індексом із списку кадрів. Якщо вказаний індекс знаходиться за межами діапазону, за замовчуванням повертається перший кадр у списку.
### Клас GifImage

#### Поля:
- **m_image**: Зображення GIF.
- **m_dimension**: Розмірність кадру.
- **m_frames_count**: Кількість кадрів у GIF.
- **m_current_frame**: Індекс поточного кадру.

#### Властивості:
- **FramesCount**: Забезпечує доступ до кількості кадрів у GIF.
- **CurrentFrame**: Забезпечує доступ до індексу поточного кадру.

#### Конструктор:
- **GifImage(Bitmap image)**: Ініціалізує новий екземпляр класу GifImage з вказаним зображенням GIF. Визначає розмірність кадру та обчислює загальну кількість кадрів.

#### Методи:
- **GetNextFrame()**: Повертає наступний кадр у GIF та зсуває індекс поточного кадру. Якщо досягнуто останнього кадру, повертає перший.
- **GetFrame(int frame_id)**: Повертає кадр за вказаним індексом у GIF.

